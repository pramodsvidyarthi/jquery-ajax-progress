compute-length-for-progress-bar